mode_of_communication_wide <- mode_of_communication_distribution %>%
pivot_wider(names_from = SN11, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(mode_of_communication_wide)
## Test
mode_of_communication_contingency_table <- table(combined_data$quartile, combined_data$SN11)
print(mode_of_communication_contingency_table)
mode_of_communication_test <- chisq.test(mode_of_communication_contingency_table)
print(mode_of_communication_test)
## Summary
length_of_friendship_distribution <- combined_data %>%
group_by(quartile, SN12) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
length_of_friendship_wide <- length_of_friendship_distribution %>%
pivot_wider(names_from = SN12, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(length_of_friendship_wide)
## Test
length_of_friendship_contingency_table <- table(combined_data$quartile, combined_data$SN12)
print(length_of_friendship_contingency_table)
length_of_friendship_test <- chisq.test(length_of_friendship_contingency_table)
print(length_of_friendship_test)
frequency_of_communication_distribution <- combined_data %>%
group_by(quartile, SN13) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
frequency_of_communication_wide <- frequency_of_communication_distribution %>%
pivot_wider(names_from = SN13, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(frequency_of_communication_wide)
## Test
frequency_of_communication_contingency_table <- table(combined_data$quartile, combined_data$SN13)
print(frequency_of_communication_contingency_table)
frequency_of_communication_test <- chisq.test(frequency_of_communication_contingency_table)
print(frequency_of_communication_test)
# Summarize for discuss_personal_matters -------------
## Summary
discuss_personal_matters_distribution <- combined_data %>%
group_by(quartile, SN14) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
discuss_personal_matters_wide <- discuss_personal_matters_distribution %>%
pivot_wider(names_from = SN14, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(discuss_personal_matters_wide)
## Test
discuss_personal_matters_contingency_table <- table(combined_data$quartile, combined_data$SN14)
print(discuss_personal_matters_contingency_table)
discuss_personal_matters_test <- chisq.test(discuss_personal_matters_contingency_table)
print(discuss_personal_matters_test)
discuss_personal_matters_contingency_table <- table(combined_data$quartile, combined_data$SN14)
print(discuss_personal_matters_contingency_table)
discuss_personal_matters_test <- chisq.test(discuss_personal_matters_contingency_table)
print(discuss_personal_matters_test)
# Summarize for ask_for_advice_on_personal_matters -------------
## Summary
ask_for_advice_distribution <- combined_data %>%
group_by(quartile, SN15) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
ask_for_advice_wide <- ask_for_advice_distribution %>%
pivot_wider(names_from = SN15, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(ask_for_advice_wide)
## Test
ask_for_advice_contingency_table <- table(combined_data$quartile, combined_data$SN15)
print(ask_for_advice_contingency_table)
ask_for_advice_test <- chisq.test(ask_for_advice_contingency_table)
print(ask_for_advice_test)
## Summary
spouse_or_partner_distribution <- combined_data %>%
group_by(quartile, SN16) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
spouse_or_partner_wide <- spouse_or_partner_distribution %>%
pivot_wider(names_from = SN16, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(spouse_or_partner_wide)
## Test
spouse_or_partner_contingency_table <- table(combined_data$quartile, combined_data$SN16)
print(spouse_or_partner_contingency_table)
spouse_or_partner_test <- chisq.test(spouse_or_partner_contingency_table)
print(spouse_or_partner_test)
# Summarize for spouse_or_intimate_partner -------------
## Summary
spouse_or_partner_distribution <- combined_data %>%
group_by(quartile, SN16) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
spouse_or_partner_wide <- spouse_or_partner_distribution %>%
pivot_wider(names_from = SN16, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(spouse_or_partner_wide)
## Test
spouse_or_partner_contingency_table <- table(combined_data$quartile, combined_data$SN16)
print(spouse_or_partner_contingency_table)
spouse_or_partner_test <- chisq.test(spouse_or_partner_contingency_table)
print(spouse_or_partner_test)
# Summarize for close_relative -------------
## Summary
close_relative_distribution <- combined_data %>%
group_by(quartile, SN17) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
close_relative_wide <- close_relative_distribution %>%
pivot_wider(names_from = SN17, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(close_relative_wide)
## Test
close_relative_contingency_table <- table(combined_data$quartile, combined_data$SN17)
print(close_relative_contingency_table)
close_relative_test <- chisq.test(close_relative_contingency_table)
print(close_relative_test)
## Summary
sexual_relationship_distribution <- combined_data %>%
group_by(quartile, SN18) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
sexual_relationship_wide <- sexual_relationship_distribution %>%
pivot_wider(names_from = SN18, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(sexual_relationship_wide)
## Test
sexual_relationship_contingency_table <- table(combined_data$quartile, combined_data$SN18)
print(sexual_relationship_contingency_table)
sexual_relationship_test <- chisq.test(sexual_relationship_contingency_table)
print(sexual_relationship_test)
# Summarize for cohabiting -------------
## Summary
cohabiting_distribution <- combined_data %>%
group_by(quartile, SN19) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
cohabiting_wide <- cohabiting_distribution %>%
pivot_wider(names_from = SN19, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(cohabiting_wide)
## Test
cohabiting_contingency_table <- table(combined_data$quartile, combined_data$SN19)
print(cohabiting_contingency_table)
cohabiting_test <- chisq.test(cohabiting_contingency_table)
print(cohabiting_test)
# Summarize for smokes_tobacco -------------
## Summary
smokes_tobacco_distribution <- combined_data %>%
group_by(quartile, SN20) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
smokes_tobacco_wide <- smokes_tobacco_distribution %>%
pivot_wider(names_from = SN20, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(smokes_tobacco_wide)
## Test
smokes_tobacco_contingency_table <- table(combined_data$quartile, combined_data$SN20)
print(smokes_tobacco_contingency_table)
smokes_tobacco_test <- chisq.test(smokes_tobacco_contingency_table)
print(smokes_tobacco_test)
# Summarize for encouraged_to_smoke_during_covid -------------
## Summary
encouraged_to_smoke_distribution <- combined_data %>%
group_by(quartile, SN21) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
encouraged_to_smoke_wide <- encouraged_to_smoke_distribution %>%
pivot_wider(names_from = SN21, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(encouraged_to_smoke_wide)
## Test
encouraged_to_smoke_contingency_table <- table(combined_data$quartile, combined_data$SN21)
print(encouraged_to_smoke_contingency_table)
encouraged_to_smoke_test <- chisq.test(encouraged_to_smoke_contingency_table)
print(encouraged_to_smoke_test)
## Summary
drinks_alcohol_distribution <- combined_data %>%
group_by(quartile, SN22) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
drinks_alcohol_wide <- drinks_alcohol_distribution %>%
pivot_wider(names_from = SN22, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(drinks_alcohol_wide)
## Test
drinks_alcohol_contingency_table <- table(combined_data$quartile, combined_data$SN22)
print(drinks_alcohol_contingency_table)
drinks_alcohol_test <- chisq.test(drinks_alcohol_contingency_table)
print(drinks_alcohol_test)
# Summarize for how_often_drinks_alcohol -------------
## Summary
how_often_drinks_distribution <- combined_data %>%
group_by(quartile, SN22a) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
how_often_drinks_wide <- how_often_drinks_distribution %>%
pivot_wider(names_from = SN22a, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(how_often_drinks_wide)
## Test
how_often_drinks_contingency_table <- table(combined_data$quartile, combined_data$SN22a)
print(how_often_drinks_contingency_table)
how_often_drinks_test <- chisq.test(how_often_drinks_contingency_table)
print(how_often_drinks_test)
## Summary
encouraged_to_drink_distribution <- combined_data %>%
group_by(quartile, SN23) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
encouraged_to_drink_wide <- encouraged_to_drink_distribution %>%
pivot_wider(names_from = SN23, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(encouraged_to_drink_wide)
## Test
encouraged_to_drink_contingency_table <- table(combined_data$quartile, combined_data$SN23)
print(encouraged_to_drink_contingency_table)
encouraged_to_drink_test <- chisq.test(encouraged_to_drink_contingency_table)
print(encouraged_to_drink_test)
## Summary
uses_drugs_distribution <- combined_data %>%
group_by(quartile, SN25) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
uses_drugs_wide <- uses_drugs_distribution %>%
pivot_wider(names_from = SN25, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(uses_drugs_wide)
## Test
uses_drugs_contingency_table <- table(combined_data$quartile, combined_data$SN25)
print(uses_drugs_contingency_table)
uses_drugs_test <- chisq.test(uses_drugs_contingency_table)
print(uses_drugs_test)
encouraged_to_use_drugs_distribution <- combined_data %>%
group_by(quartile, SN26) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
encouraged_to_use_drugs_wide <- encouraged_to_use_drugs_distribution %>%
pivot_wider(names_from = SN26, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(encouraged_to_use_drugs_wide)
## Test
encouraged_to_use_drugs_contingency_table <- table(combined_data$quartile, combined_data$SN26)
print(encouraged_to_use_drugs_contingency_table)
encouraged_to_use_drugs_test <- chisq.test(encouraged_to_use_drugs_contingency_table)
print(encouraged_to_use_drugs_test)
# Summarize for tested_for_covid -------------
## Summary
tested_for_covid_distribution <- combined_data %>%
group_by(quartile, SN27) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
tested_for_covid_wide <- tested_for_covid_distribution %>%
pivot_wider(names_from = SN27, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(tested_for_covid_wide)
## Test
tested_for_covid_contingency_table <- table(combined_data$quartile, combined_data$SN27)
print(tested_for_covid_contingency_table)
tested_for_covid_test <- chisq.test(tested_for_covid_contingency_table)
print(tested_for_covid_test)
# Summarize for tested_positive_for_covid -------------
## Summary
tested_positive_distribution <- combined_data %>%
group_by(quartile, SN27a) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
tested_positive_wide <- tested_positive_distribution %>%
pivot_wider(names_from = SN27a, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(tested_positive_wide)
## Test
tested_positive_contingency_table <- table(combined_data$quartile, combined_data$SN27a)
print(tested_positive_contingency_table)
tested_positive_test <- chisq.test(tested_positive_contingency_table)
print(tested_positive_test)
# Summarize for hospitalized_for_covid -------------
## Summary
hospitalized_for_covid_distribution <- combined_data %>%
group_by(quartile, SN27a1) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
hospitalized_for_covid_wide <- hospitalized_for_covid_distribution %>%
pivot_wider(names_from = SN27a1, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(hospitalized_for_covid_wide)
## Test
hospitalized_for_covid_contingency_table <- table(combined_data$quartile, combined_data$SN27a1)
print(hospitalized_for_covid_contingency_table)
hospitalized_for_covid_test <- chisq.test(hospitalized_for_covid_contingency_table)
print(hospitalized_for_covid_test)
# Summarize for knows_anyone_hospitalized_for_covid -------------
## Summary
knows_anyone_hospitalized_for_covid_distribution <- combined_data %>%
group_by(quartile, SN28) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
rm(list=ls())
knitr::opts_knit$set(root.dir = "/Volumes/caas/CADRE CLC Data Project5/Clean Data/AK-SU-NETWORKS-ROUT")
rm(list=ls())
library(dplyr)
# Top matter ----------
rm(list=ls())
library(haven)
library(dplyr)
library(data.table)
library(tidyverse)
# Read data ----------
data_loc <- "/Volumes/caas/CADRE CLC Data Project5/Clean Data/AK-SU-NETWORKS-ROUT/"
sns_consenting_dt <- readRDS(paste0(data_loc, "sns_consenting_dt.RDS"))
dim(sns_consenting_dt)
sns_dt_long_wide_no_minors <- readRDS(paste0(data_loc, "sns_dt_long_wide_no_minors.RDS"))
dim(sns_dt_long_wide_no_minors)
sns_dt_long_wide_no_minors
# Classify egos into quartiles based on their CDC score ----------
sns_consenting_dt <- sns_consenting_dt %>%
mutate(quartile = ntile(cdc_avg_out, 4))
# Join the ego and alter datasets using the MTURK1 and MTURKID columns: ----------
combined_data <- left_join(sns_dt_long_wide_no_minors, sns_consenting_dt,
by = c("MTURKID" = "MTURK1"))
combined_data
table(combined_data$quartile)
# Summarize for knows_anyone_hospitalized_for_covid -------------
## Summary
knows_anyone_hospitalized_for_covid_distribution <- combined_data %>%
group_by(quartile, SN28) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
knows_anyone_hospitalized_for_covid_wide <- knows_anyone_hospitalized_for_covid_distribution %>%
pivot_wider(names_from = SN28, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(knows_anyone_hospitalized_for_covid_wide)
## Test
knows_anyone_hospitalized_for_covid_contingency_table <- table(combined_data$quartile, combined_data$SN28)
print(knows_anyone_hospitalized_for_covid_contingency_table)
knows_anyone_hospitalized_for_covid_test <- chisq.test(knows_anyone_hospitalized_for_covid_contingency_table)
print(knows_anyone_hospitalized_for_covid_test)
# Summarize for encouraged_testing_for_covid -------------
## Summary
encouraged_testing_for_covid_distribution <- combined_data %>%
group_by(quartile, SN32) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
encouraged_testing_for_covid_wide <- encouraged_testing_for_covid_distribution %>%
pivot_wider(names_from = SN32, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(encouraged_testing_for_covid_wide)
## Test
encouraged_testing_for_covid_contingency_table <- table(combined_data$quartile, combined_data$SN32)
print(encouraged_testing_for_covid_contingency_table)
encouraged_testing_for_covid_test <- chisq.test(encouraged_testing_for_covid_contingency_table)
print(encouraged_testing_for_covid_test)
# Summarize for follows_social_distancing -------------
## Summary
follows_social_distancing_distribution <- combined_data %>%
group_by(quartile, SN33) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
follows_social_distancing_wide <- follows_social_distancing_distribution %>%
pivot_wider(names_from = SN33, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(follows_social_distancing_wide)
## Test
follows_social_distancing_contingency_table <- table(combined_data$quartile, combined_data$SN33)
print(follows_social_distancing_contingency_table)
follows_social_distancing_test <- chisq.test(follows_social_distancing_contingency_table)
print(follows_social_distancing_test)
# Summarize for encouraged_social_distancing -------------
## Summary
encouraged_social_distancing_distribution <- combined_data %>%
group_by(quartile, SN34) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
encouraged_social_distancing_wide <- encouraged_social_distancing_distribution %>%
pivot_wider(names_from = SN34, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(encouraged_social_distancing_wide)
## Test
encouraged_social_distancing_contingency_table <- table(combined_data$quartile, combined_data$SN34)
print(encouraged_social_distancing_contingency_table)
encouraged_social_distancing_test <- chisq.test(encouraged_social_distancing_contingency_table)
print(encouraged_social_distancing_test)
# Summarize for received_covid_vaccine -------------
## Summary
received_covid_vaccine_distribution <- combined_data %>%
group_by(quartile, SN37) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
received_covid_vaccine_wide <- received_covid_vaccine_distribution %>%
pivot_wider(names_from = SN37, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(received_covid_vaccine_wide)
## Test
received_covid_vaccine_contingency_table <- table(combined_data$quartile, combined_data$SN37)
print(received_covid_vaccine_contingency_table)
received_covid_vaccine_test <- chisq.test(received_covid_vaccine_contingency_table)
print(received_covid_vaccine_test)
# Summarize for vaccine_side_effects -------------
## Summary
vaccine_side_effects_distribution <- combined_data %>%
group_by(quartile, SN37a) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
vaccine_side_effects_wide <- vaccine_side_effects_distribution %>%
pivot_wider(names_from = SN37a, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(vaccine_side_effects_wide)
## Test
vaccine_side_effects_contingency_table <- table(combined_data$quartile, combined_data$SN37a)
print(vaccine_side_effects_contingency_table)
vaccine_side_effects_test <- chisq.test(vaccine_side_effects_contingency_table)
print(vaccine_side_effects_test)
# Summarize for open_to_vaccine -------------
## Summary
open_to_vaccine_distribution <- combined_data %>%
group_by(quartile, SN37b) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
open_to_vaccine_wide <- open_to_vaccine_distribution %>%
pivot_wider(names_from = SN37b, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(open_to_vaccine_wide)
## Test
open_to_vaccine_contingency_table <- table(combined_data$quartile, combined_data$SN37b)
print(open_to_vaccine_contingency_table)
open_to_vaccine_test <- chisq.test(open_to_vaccine_contingency_table)
print(open_to_vaccine_test)
# Summarize for encouraged_vaccine -------------
## Summary
encouraged_vaccine_distribution <- combined_data %>%
group_by(quartile, SN38) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
encouraged_vaccine_wide <- encouraged_vaccine_distribution %>%
pivot_wider(names_from = SN38, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(encouraged_vaccine_wide)
## Test
encouraged_vaccine_contingency_table <- table(combined_data$quartile, combined_data$SN38)
print(encouraged_vaccine_contingency_table)
encouraged_vaccine_test <- chisq.test(encouraged_vaccine_contingency_table)
print(encouraged_vaccine_test)
# Summarize for discouraged_vaccine -------------
## Summary
discouraged_vaccine_distribution <- combined_data %>%
group_by(quartile, SN39) %>%
tally() %>%
group_by(quartile) %>%
mutate(proportion = n/sum(n))
discouraged_vaccine_wide <- discouraged_vaccine_distribution %>%
pivot_wider(names_from = SN39, values_from = proportion, values_fill = 0) %>%
group_by(quartile) %>%
summarise(across(everything(), sum))
print(discouraged_vaccine_wide)
## Test
discouraged_vaccine_contingency_table <- table(combined_data$quartile, combined_data$SN39)
print(discouraged_vaccine_contingency_table)
discouraged_vaccine_test <- chisq.test(discouraged_vaccine_contingency_table)
print(discouraged_vaccine_test)
