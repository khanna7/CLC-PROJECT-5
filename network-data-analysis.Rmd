---
title: "R Notebook"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook containing 
results
from the social network data from CLC Project 5.

```{r, echo=FALSE, message=FALSE}

library(haven)
library(dplyr)

# Set working directory ---------------------------
setwd("/Volumes/caas/CADRE CLC Data Project5/Clean Data/AK-SU-NETWORKS-ROUT")

# Load complete (individual+network) data ---------------------------
load(file="eda.RData") #from "../Coronavirus Pandemic_Merge_AllData.SAV") 
dim(dt)

```


```{r}
sns_consenting_dt <- dt %>% 
  filter(FUSNCONSENT == 7)
```

```{r, echo=FALSE, results='hide'}
vars <- colnames(sns_consenting_dt)
sns_vars <- which(substr(vars, 6, 7) == "SN")
```

We start by filtering out the survey participants who did not consent to 
participate with an affirmative response to the statement:
"Yes, I agree that I have read this document, that I am 18 years of age or older, 
and I would like to participate in this study.'' We have a dataset of
`r nrow(sns_consenting_dt)` participants, reporting on a number of 
attributes of their network members, structured in `r length(sns_vars)` columns, 
with names such as `r vars[sns_vars[1]]`, `r vars[sns_vars[2]]`, ...,
`r vars[sns_vars[length(sns_vars)]]`.

For example, the variables "FUAX_SN20"report 
cigarette smoking in the network, tabulated as follows:
```{r, echo=FALSE, message=FALSE, results='hide'}
cig_net_dt <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN20,
                FUA5_SN20,
                FUA6_SN20,
                FUA7_SN20,
                FUA8_SN20
  )

```

```{r}
(apply(cig_net_dt, 2, function (x) table(x, exclude = NULL)))
```


The variables `r colnames(cig_net_dt)[[1]]` through `r colnames(cig_net_dt)[[5]]` 
report smoking in the 5 reported  network members, 
where 1 represents "yes", and 2 represents "no". 
Restricting ourselves to the confirmed yes and no reports, the proportion of
smoking persons in the social network of our MTurk sample is:  

```{r}
round(apply(cig_net_dt, 2, function (x) length(which(x==1))/sum(table(x))), 3)
```

Other reported characteristics of the social network members include: 
age (SN2), 

```{r}
age_net_dt <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN2,
                FUA5_SN2,
                FUA6_SN2,
                FUA7_SN2,
                FUA8_SN2
  )
round(apply(age_net_dt, 2, function (x) summary(x)), 2)
```
(Looks like we have reports on some children; these might have to be deleted
since the survey was meant to interview adults?)

race (SN3),

```{r}
race_net_dt_white <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN3_1,
                FUA5_SN3_1,
                FUA6_SN3_1,
                FUA7_SN3_1,
                FUA8_SN3_1
  )

race_net_dt_black <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN3_2,
                FUA5_SN3_2,
                FUA6_SN3_2,
                FUA7_SN3_2,
                FUA8_SN3_2
  )

apply(race_net_dt_white, 2, function (x) table(x))
apply(race_net_dt_black, 2, function (x) table(x))
```
(I will need to recode the other race categories since each is reported in a 
separated column);

gender (SN4), 

```{r}
gender_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN4,
                FUA5_SN4,
                FUA6_SN4,
                FUA7_SN4,
                FUA8_SN4
  )
apply(gender_net_dt, 2, table)
```
where 1=male, 2=female, 3=nonbinary, 4=transgender, 5 = don't know,

ethnicity (SN5), 

```{r}
ethnicity_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN5,
                FUA5_SN5,
                FUA6_SN5,
                FUA7_SN5,
                FUA8_SN5
  )
apply(ethnicity_net_dt, 2, function (x) table(x, exclude = NULL))
```
where 1 is Non-Hispanic, 2 is Hispanic,

education (SN6),

```{r}
education_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN6,
                FUA5_SN6,
                FUA6_SN6,
                FUA7_SN6,
                FUA8_SN6
  )
apply(education_net_dt, 2, function (x) table(x, exclude = NULL))
```
where 1, 2, 3 are HS or below, 4 is some college, 5 is college degree,
6 is beyond, and 7 is don't know,

employment (SN7), 
```{r}
employment_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN7,
                FUA5_SN7,
                FUA6_SN7,
                FUA7_SN7,
                FUA8_SN7
  )
apply(employment_net_dt, 2, function (x) table(x, exclude = NULL))
```
where 1 =	Employed works remotely; 2= Employed, works in person;  
3 = Not employed; 5=Retired;  6 = Full time student;  7 = Don't Know, 

housing (SN8),
```{r}
housing_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN8,
                FUA5_SN8,
                FUA6_SN8,
                FUA7_SN8,
                FUA8_SN8
  )
apply(housing_net_dt, 2, function (x) table(x, exclude = NULL))
```
where 1 = Rents a place to live, like a house or apartment,
2 = Owns a place to live, like a home or condo,
3 = A relative or friend's home or apartment,
4 = Group home, boarding house, or half-way house, 
5 = In a dorm or other campus housing  (5),
6 = someplace else (----),
7 = Don't know

political party/affiliation (SN9), 
```{r}
political_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN9,
                FUA5_SN9,
                FUA6_SN9,
                FUA7_SN9,
                FUA8_SN9
  )
apply(political_net_dt, 2, function (x) table(x, exclude = NULL))
```

mode(s) of communication (SN10), 

```{r}
comm_modes_net_dt <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                unlist(lapply(1:5, function (x) paste0("FUA4_SN10_",x))),
                unlist(lapply(1:5, function (x) paste0("FUA5_SN10_",x))),
                unlist(lapply(1:5, function (x) paste0("FUA6_SN10_",x))),
                unlist(lapply(1:5, function (x) paste0("FUA7_SN10_",x))),
                unlist(lapply(1:5, function (x) paste0("FUA8_SN10_",x)))
  )
   
apply(comm_modes_net_dt, 2, function (x) table(x, exclude = NULL))
```
where 1=in-person, 2=social media, 3=text/messaging, 4 = phone call, 5=video conference/vide chat.

most frequently used mode of communication (SN11),

```{r}
freq_comm_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN11,
                FUA5_SN11,
                FUA6_SN11,
                FUA7_SN11,
                FUA8_SN11
  )
apply(freq_comm_net_dt, 2, function (x) table(x, exclude = NULL))
```
where 6=in-person, 7=social media, 8=text/messaging, 9=phone call,
10 = video conference/video chat.


length of friendship (SN12),
```{r}
rel_leng_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN12,
                FUA5_SN12,
                FUA6_SN12,
                FUA7_SN12,
                FUA8_SN12
  )
apply(rel_leng_net_dt, 2, function (x) table(x, exclude = NULL))
```
where:
1:   Less than a year,
2:          1-2 years,
3: 2-5 years,
4:         5-10 years
5: More than 10 years

frequency of communication (SN13),
```{r}
freq_comm_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN13,
                FUA5_SN13,
                FUA6_SN13,
                FUA7_SN13,
                FUA8_SN13
  )
apply(freq_comm_net_dt, 2, function (x) table(x, exclude = NULL))
```
where:
    1:             Daily,
     2:    Every few days,
     3:            Weekly,
     4:           Monthly,
     5: Less than monthly


whether the participant discusses personal matters with the network member (SN14),

```{r}
personal_matts_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN14,
                FUA5_SN14,
                FUA6_SN14,
                FUA7_SN14,
                FUA8_SN14
  )
apply(personal_matts_net_dt, 2, function (x) table(x, exclude = NULL))
```

whether the participant asks the network member for advice on personal matters (SN15),

whether the network member is a spouse or intimate partner (SN16),

```{r}
intimate_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN16,
                FUA5_SN16,
                FUA6_SN16,
                FUA7_SN16,
                FUA8_SN16 
  )
apply(intimate_net_dt, 2, function (x) table(x, exclude = NULL))
```
where:
    1:   Yes,
     2:    No
     
whether the network member is a close relative (parent/grandparent/sibling) (SN17),

```{r}
bloodrel_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN17,
                FUA5_SN17,
                FUA6_SN17,
                FUA7_SN17,
                FUA8_SN17 
  )
apply(bloodrel_net_dt, 2, function (x) table(x, exclude = NULL))
```
where:
     1:   Yes
     2:    No

whether there participant has a sexual relationship with the network member (SN18),

```{r}
sexpt_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN18,
                FUA5_SN18,
                FUA6_SN18,
                FUA7_SN18,
                FUA8_SN18 
  )
apply(sexpt_net_dt, 2, function (x) table(x, exclude = NULL))
```
where 
     1: Yes,
     2: No
     
whether the participant lives with the network member (SN19),

```{r}
cohab_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN19,
                FUA5_SN19,
                FUA6_SN19,
                FUA7_SN19,
                FUA8_SN19 
  )
apply(cohab_net_dt, 2, function (x) table(x, exclude = NULL))
```

whether the network member smokes tobacco (cigarettes or cigars) (SN20, ),


```{r}
(apply(cig_net_dt, 2, function (x) table(x, exclude = NULL)))
```
where 
     1: Yes,
     2: No

and, if so, how often (SN20a),


```{r}
freq_tobacco_smkg <- 
  sns_consenting_dt %>% select(
                FUA4_SN20a,
                FUA5_SN20a,
                FUA6_SN20a,
                FUA7_SN20a,
                FUA8_SN20a 
  )
apply(freq_tobacco_smkg, 2, function (x) table(x, exclude = NULL))

```
where 
1: Daily,
2: Less than Daily

If the network member has encouraged the participant to smoke tobacco with them 
since the start of COVID-19 (SN21),

```{r}
enc_tobacco_smkg <- 
  sns_consenting_dt %>% select(
                FUA4_SN21,
                FUA5_SN21,
                FUA6_SN21,
                FUA7_SN21,
                FUA8_SN21 
  )
apply(enc_tobacco_smkg, 2, function (x) table(x, exclude = NULL))

```

if so, how often (SN 21a),

```{r}
freq_enc_tobacco_smkg <- 
  sns_consenting_dt %>% select(
                FUA4_SN21a,
                FUA5_SN21a,
                FUA6_SN21a,
                FUA7_SN21a,
                FUA8_SN21a 
  )
apply(freq_enc_tobacco_smkg, 2, function (x) table(x, exclude = NULL))

```
where:
  1=daily,
  2=every few days,
  3=weekly,
  4=monthly
  5=less than monthly
  
Whether the network member drinks alcohol (wine, beer or liquor) (SN22),
if so, how often (SN22a),

```{r}
alc_use_net_dt <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN22,
                FUA5_SN22,
                FUA6_SN22,
                FUA7_SN22,
                FUA8_SN22 
  )
apply(alc_use_net_dt, 2, function (x) table(x, exclude = NULL))
```
where 
  1=yes,
  2=no

```{r}
freq_alc_use_net_dt <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN22a,
                FUA5_SN22a,
                FUA6_SN22a,
                FUA7_SN22a,
                FUA8_SN22a 
  )
apply(freq_alc_use_net_dt, 2, function (x) table(x, exclude = NULL))
```
where:
  1=Daily,
  2=Few Times/week,
  3=Few Times/month,
  4=Monthly or Less,
  5=Don't Know

Whether the network member has encouraged the participant to drink alcohol with them since the start of COVID-19 (SN23),
if so, how often (SN23a):

```{r}
enc_alc_use_net_dt <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN23,
                FUA5_SN23,
                FUA6_SN23,
                FUA7_SN23,
                FUA8_SN23 
  )
apply(enc_alc_use_net_dt, 2, function (x) table(x, exclude = NULL))
```
where:
  1 = Yes,
  2 = No
  
```{r}
freq_enc_alc_use_net_dt <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN23a,
                FUA5_SN23a,
                FUA6_SN23a,
                FUA7_SN23a,
                FUA8_SN23a 
  )
apply(freq_enc_alc_use_net_dt, 
      2, function (x) table(x, exclude = NULL))
```

where:
  1 =	Daily   
  2 = Every few days
  3 = Weekly
  4 = Monthly
  5 = Less than monthly  
  
and, if in a bar, restaurant, or other public place (SN24),

```{r}
public_enc_alc_use_net_dt <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN24,
                FUA5_SN24,
                FUA6_SN24,
                FUA7_SN24,
                FUA8_SN24 
  )
apply(public_enc_alc_use_net_dt, 
      2, function (x) table(x, exclude = NULL))
```
where:
  1 = Yes
  2 = No
  
if the network member uses non-prescription drugs (cocaine, painkiller pills, heroin, fentanyl, methamphetamine, or marijuana) (SN25),

```{r}
np_drugs_net <- 
  sns_consenting_dt %>% select(
                FUA4_SN25,
                FUA5_SN25,
                FUA6_SN25,
                FUA7_SN25,
                FUA8_SN25 
  )
apply(np_drugs_net, 
      2, function (x) table(x, exclude = NULL))
```
where:
  1=Yes,
  2=No
  
if so, which drugs the network member uses (SN25a), how often (SN25b),

```{r}
np_which_drugs_net <- 
  sns_consenting_dt %>% select(
                unlist(lapply(1:7, function (x) paste0("FUA4_SN25a_",x))),
                unlist(lapply(1:7, function (x) paste0("FUA5_SN25a_",x))),
                unlist(lapply(1:7, function (x) paste0("FUA6_SN25a_",x))),
                unlist(lapply(1:7, function (x) paste0("FUA7_SN25a_",x))),
                unlist(lapply(1:7, function (x) paste0("FUA8_SN25a_",x)))
  )
apply(np_which_drugs_net, 
      2, function (x) table(x, exclude = NULL))
```
where:
▢	Cocaine  (1) 
▢	Methamphetamine  (2) 
▢	Other stimulants or uppers  (3) 
▢	Painkiller pills, such as oxycodone or hydrocodone  (4) 
▢	Heroin  (5) 
▢	Fentanyl  (6) 
▢	Marijuana  (7) 
▢	Other:  (8) ________________________________________________
▢	Don't know  (9) 


```{r}
np_drugs_net_cat8 <- 
  sns_consenting_dt %>% select(
                FUA4_SN25a_8,
                FUA5_SN25a_8,
                FUA6_SN25a_8,
                FUA7_SN25a_8,
                FUA8_SN25a_8 
  )
apply(np_drugs_net_cat8, 
      2, function (x) table(x, exclude = NULL))

np_drugs_net_text <- 
  sns_consenting_dt %>% select(
                FUA4_SN25a_8_TEXT,
                FUA5_SN25a_8_TEXT,
                FUA6_SN25a_8_TEXT,
                FUA7_SN25a_8_TEXT,
                FUA8_SN25a_8_TEXT 
  )
apply(np_drugs_net_text, 
      2, function (x) table(x, exclude = NULL))
```

and if the network member has encouraged the participant to use drugs with them (SN26), 
and how often (SN26b);

```{r}
enc_np_drugs_net <- 
  sns_consenting_dt %>% select(
                FUA4_SN26,
                FUA5_SN26,
                FUA6_SN26,
                FUA7_SN26,
                FUA8_SN26 
  )
apply(enc_np_drugs_net, 
      2, function (x) table(x, exclude = NULL))

freq_enc_np_drugs_net <- 
  sns_consenting_dt %>% select(
                FUA4_SN26b,
                FUA5_SN26b,
                FUA6_SN26b,
                FUA7_SN26b,
                FUA8_SN26b 
  )
apply(freq_enc_np_drugs_net, 
      2, function (x) table(x, exclude = NULL))
```
where for 26 1=Yes and 2=No
and for 26b:

o	Daily  (1) 
o	Every few days  (2) 
o	Weekly  (3) 
o	Monthly  (4) 
o	Less than monthly  (5) 


if the network member has been tested for COVID-19 (SN27),

```{r}
covidtest_net <- 
  sns_consenting_dt %>% select(
                FUA4_SN27,
                FUA5_SN27,
                FUA6_SN27,
                FUA7_SN27,
                FUA8_SN27 
  )
apply(covidtest_net, 
      2, function (x) table(x, exclude = NULL))
```

if the network member has tested positive for COVID-19 (SN27a),

```{r}
covidtestpos_net <- 
  sns_consenting_dt %>% select(
                FUA4_SN27a,
                FUA5_SN27a,
                FUA6_SN27a,
                FUA7_SN27a,
                FUA8_SN27a 
  )
apply(covidtestpos_net, 
      2, function (x) table(x, exclude = NULL))
```

if the network member has been hospitalized for COVID-19 (SN27a1),

```{r}
covidtesthosp_net <- 
  sns_consenting_dt %>% select(
                FUA4_SN27a1,
                FUA5_SN27a1,
                FUA6_SN27a1,
                FUA7_SN27a1,
                FUA8_SN27a1 
  )
apply(covidtesthosp_net, 
      2, function (x) table(x, exclude = NULL))
```

if the network member knows anyone who has been hospitalized for COVID-19 (SN28),

```{r}
any_hospitalized <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN28,
                FUA5_SN28,
                FUA6_SN28,
                FUA7_SN28,
                FUA8_SN28
  )
apply(any_hospitalized, 2, function (x) table(x, exclude = NULL))
```

if the network member knows anyone who has died of COVID-19 (SN29),

```{r}
any_died <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN29,
                FUA5_SN29,
                FUA6_SN29,
                FUA7_SN29,
                FUA8_SN29
  )
apply(any_died, 2, function (x) table(x, exclude = NULL))
```

if the network member has any of the listed conditions (SN30),

```{r}

vals <- 1:9

listedconditions_net <- 
  sns_consenting_dt %>% select(
    unlist(lapply(vals, function (x) paste0("FUA4_SN30_",x))),
    unlist(lapply(vals, function (x) paste0("FUA5_SN30_",x))),
    unlist(lapply(vals, function (x) paste0("FUA6_SN30_",x))),
    unlist(lapply(vals, function (x) paste0("FUA7_SN30_",x))),
    unlist(lapply(vals, function (x) paste0("FUA8_SN30_",x)))
  )
apply(listedconditions_net, 
      2, function (x) table(x, exclude = NULL))
```

where 
▢	Autoimmune disease  (1) 
▢	Cardiovascular disease, such as hypertension (high blood pressure), coronary artery disease, heart attack, or heart failure  (2) 
▢	Cerebrovascular disease, such as stroke or transient ischemic attack  (3) 
▢	Chronic lung disease, such as asthma, chronic obstructive pulmonary disease (COPD), emphysema, or pulmonary hypertension  (4) 
▢	Diabetes  (5) 
▢	Immunocompromised or immune suppressed  (6) 
▢	Kidney disease  (7) 
▢	Mental health condition (depression, anxiety, bipolar disorder, schizophrenia, PTSD, etc.)  (8) 
▢	Substance use problem  (9) 
▢	None of the above  (10) 
▢	Don't know  (11) 

if the network member's clinic, doctor's office or dental practice has closed or cancelled an appointment (SN31),

```{r}
close_medp <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN31,
                FUA5_SN31,
                FUA6_SN31,
                FUA7_SN31,
                FUA8_SN31
  )
apply(close_medp, 2, function (x) table(x, exclude = NULL))
```
where 1=Yes, 2=No, 3=Don't Know.

if the network member has ever encouraged the participant to get tested for COVID-19 (SN32),

```{r}
encd_covid_testing <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN32,
                FUA5_SN32,
                FUA6_SN32,
                FUA7_SN32,
                FUA8_SN32
  )
apply(encd_covid_testing, 2, function (x) table(x, exclude = NULL))
```

if the network member follows social distancing guidelines (SN33),
```{r}
SD_guidelines <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN33,
                FUA5_SN33,
                FUA6_SN33,
                FUA7_SN33,
                FUA8_SN33
  )
apply(SD_guidelines, 2, function (x) table(x, exclude = NULL))
```

if the network member has encouraged the participant to follow social distancing guidelines (SN34),

```{r}
encd_SD_guidelines <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN34,
                FUA5_SN34,
                FUA6_SN34,
                FUA7_SN34,
                FUA8_SN34
  )
apply(encd_SD_guidelines, 2, function (x) table(x, exclude = NULL))
```

how often the network member wears a mask in public (SN35),

if the network member has encouraged the participant to wear a mask in public (SN36),

if the network member has received at least one dose of the COVID-19 vaccine (SN37),
if the network member had a negative reaction or bad side effects after the COVID-19 vaccine (SN37a),
if the network member is open to receiving a vaccine (SN37b),

```{r}
recd_one_dose_net_dt<- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN37,
                FUA5_SN37,
                FUA6_SN37,
                FUA7_SN37,
                FUA8_SN37
  )
apply(recd_one_dose_net_dt, 2, function (x) table(x, exclude = NULL))
```
where 1=Yes, 2=No.

if the network member has encouraged the participant to get the COVID-19 vaccine (SN38),

```{r}
encd_vaccine_net_dt <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN38,
                FUA5_SN38,
                FUA6_SN38,
                FUA7_SN38,
                FUA8_SN38
  )
apply(encd_vaccine_net_dt, 2, function (x) table(x, exclude = NULL))
```
where 1=Yes, 2=No.

if the network member has discouraged the participant from getting the COVID-19 vaccine (SN39).

```{r}
discd_vaccine_net_dt <- 
  sns_consenting_dt %>% select(#comp_code_Text_Set,
                FUA4_SN39,
                FUA5_SN39,
                FUA6_SN39,
                FUA7_SN39,
                FUA8_SN39
  )
apply(discd_vaccine_net_dt, 2, function (x) table(x, exclude = NULL))
```












